# ===========================================
# ModelForge - Environment Configuration
# ===========================================

# === Project ===
COMPOSE_PROJECT_NAME=modelforge

# === Kafka ===
KAFKA_BOOTSTRAP_SERVERS=kafka:9092
KAFKA_TOPIC=modelforge.generation.requests
KAFKA_GROUP_ID=modelforge.ml-workers
KAFKA_BROKER_ID=1
KAFKA_ZOOKEEPER_CONNECT=zookeeper:2181
KAFKA_ADVERTISED_LISTENERS=PLAINTEXT://kafka:9092,OUTSIDE://localhost:9094
KAFKA_LISTENER_SECURITY_PROTOCOL_MAP=PLAINTEXT:PLAINTEXT,OUTSIDE:PLAINTEXT
KAFKA_INTER_BROKER_LISTENER_NAME=PLAINTEXT
KAFKA_OFFSETS_TOPIC_REPLICATION_FACTOR=1
KAFKA_HEAP_OPTS=-Xmx256m -Xms256m
KAFKA_NUM_IO_THREADS=2
KAFKA_NUM_NETWORK_THREADS=2
KAFKA_LOG_RETENTION_HOURS=24
KAFKA_LOG_SEGMENT_BYTES=1073741824
KAFKA_MESSAGE_MAX_BYTES=10485760

# === Zookeeper ===
ZOOKEEPER_CLIENT_PORT=2181
ZOOKEEPER_TICK_TIME=2000
ZOO_HEAP_SIZE=256m

# === PostgreSQL ===
POSTGRES_USER=modelforge
POSTGRES_PASSWORD=changeme
POSTGRES_DB=modelforge_db
DATABASE_URL=postgresql://modelforge:changeme@postgres:5432/modelforge_db
POSTGRES_SHARED_BUFFERS=128MB
POSTGRES_EFFECTIVE_CACHE_SIZE=256MB
POSTGRES_WORK_MEM=4MB
POSTGRES_MAINTENANCE_WORK_MEM=32MB
POSTGRES_MAX_CONNECTIONS=20

# === MinIO ===
MINIO_ROOT_USER=modelforge_admin
MINIO_ROOT_PASSWORD=changeme
S3_ENDPOINT=minio:9000
S3_ACCESS_KEY=modelforge_admin
S3_SECRET_KEY=changeme
S3_BUCKET=models-output
MINIO_API_REQUESTS_MAX=10

# === ML Worker ===
ML_MOCK_MODE=true
ML_MOCK_DELAY=2.0
TRIPSR_DEVICE=cpu
TRIPSR_MODEL_PATH=

# === Logging ===
LOG_LEVEL=INFO
LOG_FORMAT=json
SERVICE_NAME=modelforge-ml-worker
ENVIRONMENT=development
APP_VERSION=0.1.0

# === Python Optimizations ===
PYTHONUNBUFFERED=1
MALLOC_ARENA_MAX=2
OMP_NUM_THREADS=1
MKL_NUM_THREADS=1
TORCH_NUM_THREADS=1

# === Resource Limits ===
KAFKA_MEM_LIMIT=768m
KAFKA_CPU_LIMIT=1.0
ZOOKEEPER_MEM_LIMIT=512m
ZOOKEEPER_CPU_LIMIT=0.5
POSTGRES_MEM_LIMIT=512m
POSTGRES_CPU_LIMIT=0.5
MINIO_MEM_LIMIT=512m
MINIO_CPU_LIMIT=0.5
ML_WORKER_MEM_LIMIT=1g
ML_WORKER_CPU_LIMIT=1.0
LOKI_MEM_LIMIT=256m
LOKI_CPU_LIMIT=0.3
PROMTAIL_MEM_LIMIT=128m
PROMTAIL_CPU_LIMIT=0.2
GRAFANA_MEM_LIMIT=256m
GRAFANA_CPU_LIMIT=0.3
MINIO_SEED_MEM_LIMIT=512m
MINIO_SEED_CPU_LIMIT=0.5

# === Ports ===
ZOOKEEPER_PORT=2181
KAFKA_PORT_1=9092
KAFKA_PORT_2=9094
POSTGRES_PORT=5432
MINIO_PORT=9000
MINIO_CONSOLE_PORT=9001
LOKI_PORT=3100
GRAFANA_PORT=3000
GRAFANA_ADMIN_USER=admin
GRAFANA_ADMIN_PASSWORD=changeme
